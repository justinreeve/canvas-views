"use strict";function initConfigDefaults(){void 0===config.escapeMode&&(config.escapeMode=!0),config.attributePrefix=config.attributePrefix||"_",config.arrayAccessForm=config.arrayAccessForm||"none",config.emptyNodeForm=config.emptyNodeForm||"text",void 0===config.enableToStringFunc&&(config.enableToStringFunc=!0),config.arrayAccessFormPaths=config.arrayAccessFormPaths||[],void 0===config.skipEmptyTextNodesForObj&&(config.skipEmptyTextNodesForObj=!0),void 0===config.stripWhitespaces&&(config.stripWhitespaces=!0),config.datetimeAccessFormPaths=config.datetimeAccessFormPaths||[],void 0===config.useDoubleQuotes&&(config.useDoubleQuotes=!1),config.xmlElementsFilter=config.xmlElementsFilter||[],config.jsonPropertiesFilter=config.jsonPropertiesFilter||[],void 0===config.keepCData&&(config.keepCData=!1)}function initRequiredPolyfills(){}function getNodeLocalName(node){var nodeLocalName=node.localName;return null==nodeLocalName&&(nodeLocalName=node.baseName),null!=nodeLocalName&&""!=nodeLocalName||(nodeLocalName=node.nodeName),nodeLocalName}function getNodePrefix(node){return node.prefix}function escapeXmlChars(str){return"string"==typeof str?str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):str}function unescapeXmlChars(str){return str.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&apos;/g,"'").replace(/&amp;/g,"&")}function checkInStdFiltersArrayForm(stdFiltersArrayForm,obj,name,path){for(var idx=0;idx<stdFiltersArrayForm.length;idx++){var filterPath=stdFiltersArrayForm[idx];if("string"==typeof filterPath){if(filterPath==path)break}else if(filterPath instanceof RegExp){if(filterPath.test(path))break}else if("function"==typeof filterPath&&filterPath(obj,name,path))break}return idx!=stdFiltersArrayForm.length}function toArrayAccessForm(obj,childName,path){switch(config.arrayAccessForm){case"property":obj[childName]instanceof Array?obj[childName+"_asArray"]=obj[childName]:obj[childName+"_asArray"]=[obj[childName]]}!(obj[childName]instanceof Array)&&config.arrayAccessFormPaths.length>0&&checkInStdFiltersArrayForm(config.arrayAccessFormPaths,obj,childName,path)&&(obj[childName]=[obj[childName]])}function fromXmlDateTime(prop){var bits=prop.split(/[-T:+Z]/g),d=new Date(bits[0],bits[1]-1,bits[2]),secondBits=bits[5].split(".");if(d.setHours(bits[3],bits[4],secondBits[0]),secondBits.length>1&&d.setMilliseconds(secondBits[1]),bits[6]&&bits[7]){var offsetMinutes=60*bits[6]+Number(bits[7]),sign=/\d\d-\d\d:\d\d$/.test(prop)?"-":"+";offsetMinutes=0+("-"==sign?-1*offsetMinutes:offsetMinutes),d.setMinutes(d.getMinutes()-offsetMinutes-d.getTimezoneOffset())}else prop.indexOf("Z",prop.length-1)!==-1&&(d=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate(),d.getHours(),d.getMinutes(),d.getSeconds(),d.getMilliseconds())));return d}function checkFromXmlDateTimePaths(value,childName,fullPath){if(config.datetimeAccessFormPaths.length>0){var path=fullPath.split(".#")[0];return checkInStdFiltersArrayForm(config.datetimeAccessFormPaths,value,childName,path)?fromXmlDateTime(value):value}return value}function checkXmlElementsFilter(obj,childType,childName,childPath){return!(childType==DOMNodeTypes.ELEMENT_NODE&&config.xmlElementsFilter.length>0)||checkInStdFiltersArrayForm(config.xmlElementsFilter,obj,childName,childPath)}function parseDOMChildren(node,path){if(node.nodeType==DOMNodeTypes.DOCUMENT_NODE){for(var result=new Object,nodeChildren=node.childNodes,cidx=0;cidx<nodeChildren.length;cidx++){var child=nodeChildren.item(cidx);if(child.nodeType==DOMNodeTypes.ELEMENT_NODE){var childName=getNodeLocalName(child);result[childName]=parseDOMChildren(child,childName)}}return result}if(node.nodeType==DOMNodeTypes.ELEMENT_NODE){var result=new Object;result.__cnt=0;for(var nodeChildren=node.childNodes,cidx=0;cidx<nodeChildren.length;cidx++){var child=nodeChildren.item(cidx),childName=getNodeLocalName(child);if(child.nodeType!=DOMNodeTypes.COMMENT_NODE){var childPath=path+"."+childName;checkXmlElementsFilter(result,child.nodeType,childName,childPath)&&(result.__cnt++,null==result[childName]?(result[childName]=parseDOMChildren(child,childPath),toArrayAccessForm(result,childName,childPath)):(null!=result[childName]&&(result[childName]instanceof Array||(result[childName]=[result[childName]],toArrayAccessForm(result,childName,childPath))),result[childName][result[childName].length]=parseDOMChildren(child,childPath)))}}for(var aidx=0;aidx<node.attributes.length;aidx++){var attr=node.attributes.item(aidx);result.__cnt++,result[config.attributePrefix+attr.name]=attr.value}var nodePrefix=getNodePrefix(node);return null!=nodePrefix&&""!=nodePrefix&&(result.__cnt++,result.__prefix=nodePrefix),null!=result["#text"]&&(result.__text=result["#text"],result.__text instanceof Array&&(result.__text=result.__text.join("\n")),config.stripWhitespaces&&(result.__text=result.__text.trim()),delete result["#text"],"property"==config.arrayAccessForm&&delete result["#text_asArray"],result.__text=checkFromXmlDateTimePaths(result.__text,childName,path+"."+childName)),null!=result["#cdata-section"]&&(result.__cdata=result["#cdata-section"],delete result["#cdata-section"],"property"==config.arrayAccessForm&&delete result["#cdata-section_asArray"]),0==result.__cnt&&"text"==config.emptyNodeForm?result="":1==result.__cnt&&null!=result.__text?result=result.__text:1!=result.__cnt||null==result.__cdata||config.keepCData?result.__cnt>1&&null!=result.__text&&config.skipEmptyTextNodesForObj&&(config.stripWhitespaces&&""==result.__text||""==result.__text.trim())&&delete result.__text:result=result.__cdata,delete result.__cnt,!config.enableToStringFunc||null==result.__text&&null==result.__cdata||(result.toString=function(){return(null!=this.__text?this.__text:"")+(null!=this.__cdata?this.__cdata:"")}),result}if(node.nodeType==DOMNodeTypes.TEXT_NODE||node.nodeType==DOMNodeTypes.CDATA_SECTION_NODE)return node.nodeValue}function startTag(jsonObj,element,attrList,closed){var resultStr="<"+(null!=jsonObj&&null!=jsonObj.__prefix?jsonObj.__prefix+":":"")+element;if(null!=attrList)for(var aidx=0;aidx<attrList.length;aidx++){var attrName=attrList[aidx],attrVal=jsonObj[attrName];config.escapeMode&&(attrVal=escapeXmlChars(attrVal)),resultStr+=" "+attrName.substr(config.attributePrefix.length)+"=",resultStr+=config.useDoubleQuotes?'"'+attrVal+'"':"'"+attrVal+"'"}return resultStr+=closed?"/>":">"}function endTag(jsonObj,elementName){return"</"+(null!=jsonObj.__prefix?jsonObj.__prefix+":":"")+elementName+">"}function endsWith(str,suffix){return str.indexOf(suffix,str.length-suffix.length)!==-1}function jsonXmlSpecialElem(jsonObj,jsonObjField){return!!("property"==config.arrayAccessForm&&endsWith(jsonObjField.toString(),"_asArray")||0==jsonObjField.toString().indexOf(config.attributePrefix)||0==jsonObjField.toString().indexOf("__")||jsonObj[jsonObjField]instanceof Function)}function jsonXmlElemCount(jsonObj){var elementsCnt=0;if(jsonObj instanceof Object)for(var it in jsonObj)jsonXmlSpecialElem(jsonObj,it)||elementsCnt++;return elementsCnt}function checkJsonObjPropertiesFilter(jsonObj,propertyName,jsonObjPath){return 0==config.jsonPropertiesFilter.length||""==jsonObjPath||checkInStdFiltersArrayForm(config.jsonPropertiesFilter,jsonObj,propertyName,jsonObjPath)}function parseJSONAttributes(jsonObj){var attrList=[];if(jsonObj instanceof Object)for(var ait in jsonObj)ait.toString().indexOf("__")==-1&&0==ait.toString().indexOf(config.attributePrefix)&&attrList.push(ait);return attrList}function parseJSONTextAttrs(jsonTxtObj){var result="";return null!=jsonTxtObj.__cdata&&(result+="<![CDATA["+jsonTxtObj.__cdata+"]]>"),null!=jsonTxtObj.__text&&(result+=config.escapeMode?escapeXmlChars(jsonTxtObj.__text):jsonTxtObj.__text),result}function parseJSONTextObject(jsonTxtObj){var result="";return jsonTxtObj instanceof Object?result+=parseJSONTextAttrs(jsonTxtObj):null!=jsonTxtObj&&(result+=config.escapeMode?escapeXmlChars(jsonTxtObj):jsonTxtObj),result}function getJsonPropertyPath(jsonObjPath,jsonPropName){return""===jsonObjPath?jsonPropName:jsonObjPath+"."+jsonPropName}function parseJSONArray(jsonArrRoot,jsonArrObj,attrList,jsonObjPath){var result="";if(0==jsonArrRoot.length)result+=startTag(jsonArrRoot,jsonArrObj,attrList,!0);else for(var arIdx=0;arIdx<jsonArrRoot.length;arIdx++)result+=startTag(jsonArrRoot[arIdx],jsonArrObj,parseJSONAttributes(jsonArrRoot[arIdx]),!1),result+=parseJSONObject(jsonArrRoot[arIdx],getJsonPropertyPath(jsonObjPath,jsonArrObj)),result+=endTag(jsonArrRoot[arIdx],jsonArrObj);return result}function parseJSONObject(jsonObj,jsonObjPath){var result="",elementsCnt=jsonXmlElemCount(jsonObj);if(elementsCnt>0)for(var it in jsonObj)if(!jsonXmlSpecialElem(jsonObj,it)&&(""==jsonObjPath||checkJsonObjPropertiesFilter(jsonObj,it,getJsonPropertyPath(jsonObjPath,it)))){var subObj=jsonObj[it],attrList=parseJSONAttributes(subObj);if(null==subObj||void 0==subObj)result+=startTag(subObj,it,attrList,!0);else if(subObj instanceof Object)if(subObj instanceof Array)result+=parseJSONArray(subObj,it,attrList,jsonObjPath);else if(subObj instanceof Date)result+=startTag(subObj,it,attrList,!1),result+=subObj.toISOString(),result+=endTag(subObj,it);else{var subObjElementsCnt=jsonXmlElemCount(subObj);subObjElementsCnt>0||null!=subObj.__text||null!=subObj.__cdata?(result+=startTag(subObj,it,attrList,!1),result+=parseJSONObject(subObj,getJsonPropertyPath(jsonObjPath,it)),result+=endTag(subObj,it)):result+=startTag(subObj,it,attrList,!0)}else result+=startTag(subObj,it,attrList,!1),result+=parseJSONTextObject(subObj),result+=endTag(subObj,it)}return result+=parseJSONTextObject(jsonObj)}function registerElementsForTemplate(template,xmlString){var xml,xmlDoc,xmlJSON,templateObjName=CanvasViewUtils.titlecase(template);console.log(templateObjName),prepareObj(templateObjName),xml=$(xmlString),xmlDoc=$.parseXML(xmlString),xmlJSON=parseDOMChildren(xmlDoc);var obj=getChildren(templateObjName,xml,0);return console.log(obj[0].outerHTML),obj}function prepareObj(templateObjName){if(window.CV[templateObjName]){var obj=window.CV[templateObjName];for(var property in obj)obj.hasOwnProperty(property)}}function getChildren(templateObjName,xml,currentIndex,parentObj){var elementVarName,children,jqElement,xmlObj=$(xml[0]);return console.log(xmlObj),"undefined"==typeof currentIndex&&(currentIndex=0),xmlObj[0].localName.indexOf("-")>-1&&(elementVarName=CanvasViewUtils.hyphenToCamelcase(xmlObj[0].localName),window.CV[templateObjName][elementVarName]&&(jqElement=window.CV[templateObjName][elementVarName],void 0!==typeof xmlObj[0].textContent&&""!=xmlObj[0].textContent&&jqElement.text(xmlObj[0].textContent))),children=xmlObj.children(),children.length>0&&children.each(function(){return console.log(children.html()),getChildren(templateObjName,children,currentIndex+1)}),xmlObj}function getTemplateNameForPath(path){for(var arr=CVConfig.pages,i=0;i<arr.length;i++)if(arr[i].hasOwnProperty("path")&&arr[i].path==path)return arr[i].template;return null}var config=config||{};initConfigDefaults(),initRequiredPolyfills();var DOMNodeTypes={ELEMENT_NODE:1,TEXT_NODE:3,CDATA_SECTION_NODE:4,COMMENT_NODE:8,DOCUMENT_NODE:9};console.log(ENV);var CV=new Object,CVConfig={host:"https://canvasassets.wsd.net/development/",pages:[{name:"login",path:"/login/canvas",template:"login"}],menus:{mainmenu:[{name:"evolve",title:"Evolve",action:"add",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="ic-icon-svg ic-icon-svg--courses" version="1.1" x="0" y="0" viewBox="0 0 280 259" enable-background="new 0 0 280 259" xml:space="preserve"><path d="M226.2 259H32.3c-5.9 0-10.8-4.8-10.8-10.8v-43.5H10.8C4.8 204.8 0 199.9 0 194c0-6 4.8-10.8 10.8-10.8h10.8v-21.6H10.8c-5.9 0-10.8-4.8-10.8-10.8s4.8-10.8 10.8-10.8h10.8v-21.6H10.8c-5.9 0-10.8-4.8-10.8-10.8 0-6 4.8-10.8 10.8-10.8h10.8V75.4H10.8C4.8 75.4 0 70.6 0 64.7s4.8-10.8 10.8-10.8h10.8V10.8c0-6 4.8-10.8 10.8-10.8h193.9c5.9 0 10.8 4.8 10.8 10.8v21.6h32.3c5.9 0 10.8 4.8 10.8 10.8v172.4c0 6-4.8 10.8-10.8 10.8H237v21.9C237 254.2 232.2 259 226.2 259zM43.1 237.4h172.4V21.6H43.1v32.3h10.7c5.9 0 10.8 4.8 10.8 10.8s-4.8 10.8-10.8 10.8H43.1V97h10.7c5.9 0 10.8 4.8 10.8 10.8 0 6-4.8 10.8-10.8 10.8H43.1v21.6h10.7c5.9 0 10.8 4.8 10.8 10.8s-4.8 10.8-10.8 10.8H43.1v21.6h10.7c5.9 0 10.8 4.8 10.8 10.8 0 6-4.8 10.8-10.8 10.8H43.1V237.4zM237 204.8h21.5v-21.6H237V204.8zM237 161.7h21.5v-21.6H237V161.7zM237 118.5h21.5V97H237V118.5zM237 75.4h21.5V53.9H237V75.4zM172.2 129.3H96.9c-5.9 0-10.8-4.8-10.8-10.8V64.7c0-6 4.8-10.8 10.8-10.8h75.3c5.9 0 10.8 4.8 10.8 10.8v53.9C183 124.5 178.2 129.3 172.2 129.3zM107.7 107.8h53.8V75.4h-53.8V107.8z"></path></svg>'},{name:"commons",action:"remove"},{name:"help",action:"remove"},{name:"calendar",action:"remove"},{name:"0-inbox",action:"remove"}],sectionmenu:[{}]}};CV.Menu=function(menu){function initMenu(menu){menuName=menu,"mainmenu"==menu?selectedMenu=mainMenu:"sectionmenu"==menu&&(selectedMenu=sectionMenu),selectedMenu&&selectedMenu.find("li").each(function(index){var name,title,link;title=$(this).text().trim(),name=getNameFromTitle(title),link=$(this).find("a").attr("href"),$(this).attr("data-name",name),$(this).attr("data-title",title)})}function getNameFromTitle(title){return title.replace(/\s+/g,"-").toLowerCase()}function addItem(menuitem){var html="",icon="";if("object"==typeof menuitem){console.log(menuitem),"undefined"!=typeof menuitem.icon&&(icon=menuitem.icon),"mainmenu"==menuName?html='<li class="menu-item ic-app-header__menu-list-item" data-name="'+menuitem.name+'" data-title="'+menuitem.title+'"> \t\t\t\t\t\t<a href="#" class="ic-app-header__menu-list-link" data-name="'+menuitem.name+'"> \t\t\t\t\t\t\t<div class="menu-item-icon-container" aria-hidden="true"> \t\t\t\t\t\t\t'+icon+' \t\t\t\t\t\t\t</div> \t\t\t\t\t\t\t<div class="menu-item__text"> \t\t\t\t\t\t\t'+menuitem.title+" \t\t\t\t\t\t\t</div> \t\t\t\t\t\t</a> \t\t\t\t\t</li>":menuName="sectionmenu",selectedMenu.append(html);var newItem=selectedMenu.find('a[data-name="'+menuitem.name+'"]');newItem.on("click",openPage)}}function removeItem(menuitem){var name;name="object"==typeof menuitem?menuitem.name:getNameFromTitle(menuitem),selectedMenu.find('li[data-name="'+name+'"]').each(function(index){$(this).remove()})}function selectItem(menuitem){var name,activeClass="ic-app-header__menu-list-item--active";name="object"==typeof menuitem?menuitem.name:getNameFromTitle(menuitem),name&&(selectedMenu.find("li."+activeClass).removeClass(activeClass),selectedMenu.find('li[data-name="'+name+'"]').addClass(activeClass))}function openPage(){var page,name=$(this).data("name");selectItem(name),page=new CV.Page(name),page.open()}var selectedMenu,menuName,mainMenu=$(".ic-app-header__main-navigation ul#menu"),sectionMenu=$("#left-side ul#section-tabs");initMenu(menu),this.getMainMenu=function(){return mainMenu},this.getSectionMenu=function(){return sectionMenu},this.getSelectedMenu=function(){return selectedMenu},this.addItem=function(data){return addItem(data)},this.removeItem=function(data){return removeItem(data)}},CV.Page=function(pageName){function openTemplate(){console.log(name),htmlContainer.addClass("loading"),$.ajax({url:CVConfig.host+"views/"+name+".html",method:"GET",cache:!1}).done(function(data){var obj=registerElementsForTemplate(name,data);CV.Common.content.html(obj[0].outerHTML),htmlContainer.removeClass("loading")}).fail(function(){htmlContainer.removeClass("loading")})}var htmlContainer=$("html"),name=pageName;this.open=function(){return openTemplate()}};var Common=new Object;Common.wrapper=$("#wrapper"),Common.main=$("#main"),Common.leftSide=$("#left-side"),Common.rightSide=$("#right-side-wrapper"),Common.content=$("#content"),CV.Common=Common;var Login=new Object;Login.loginContainer=$(".ic-Login__container").clone(!0),Login.formLogin=Login.loginContainer.find("form#login_form").clone(!0),Login.googleLoginContainer=$("<div></div>"),Login.googleLoginButton=Login.formLogin.find("a.ic-Login__sso-button--google").clone(!0),Login.canvasLoginContainer=$("<div></div>"),Login.canvasLoginInputEmail=Login.formLogin.find("div.ic-Form-control.ic-Form-control--login:eq(0)").clone(!0),Login.canvasLoginInputPassword=Login.formLogin.find("div.ic-Form-control.ic-Form-control--login:eq(1)").clone(!0),Login.canvasLoginButton=Login.formLogin.find("button.Button--primary.Button--login").clone(!0),CV.Login=Login,$(function(){var currentTemplate,htmlContainer=$("html");if("undefined"!=typeof CVConfig.menus)for(var menuname in CVConfig.menus)for(var menu=new CV.Menu(menuname),i=0;i<CVConfig.menus[menuname].length;i++){var menuitem=CVConfig.menus[menuname][i];"add"==menuitem.action?menu.addItem(menuitem):"remove"==menuitem.action&&menu.removeItem(menuitem),console.log(menuitem)}currentTemplate=getTemplateNameForPath(window.location.pathname),null!==currentTemplate&&(htmlContainer.addClass("loading"),$.ajax({url:CVConfig.host+"views/"+currentTemplate+".html",method:"GET",cache:!1}).done(function(data){registerElementsForTemplate(currentTemplate,data),htmlContainer.removeClass("loading")}).fail(function(){htmlContainer.removeClass("loading")}))});var CanvasViewUtils={titlecase:function(str){return str.replace(/\w\S*/g,function(txt){return txt.charAt(0).toUpperCase()+txt.substr(1).toLowerCase()})},hyphenToCamelcase:function(str){return str.replace(/-([a-z])/g,function(g){return g[1].toUpperCase()})},camelcaseToHyphen:function(str){return str.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},inArrayOfObjects:function(key,value,arr){for(var i=0;i<arr.length;i++)if(arr[i].hasOwnProperty(key)&&arr[i][key]==value)return!0;return!1}};